<section
  id="departments"
  class="departments-section section-padding position-relative overflow-hidden"
>
  <!-- Split Background -->
  <div class="departments-bg position-absolute w-100 h-100 d-flex">
    <div class="bg-left flex-fill bg-primary-custom"></div>
    <div
      class="bg-right flex-fill"
      style="background-color: var(--secondary-beige)"
    ></div>
  </div>

  <div class="container-fluid position-relative">
    <h2 class="section-title text-white mb-5">Our Departments</h2>

    <!-- Loading State -->
    @if (loading()) {
    <div class="row">
      <div class="col-lg-6 mb-4">
        <div class="dept-column d-flex flex-wrap justify-content-center gap-4">
          @for (i of [1, 2, 3]; track i) {
          <div class="dept-card text-center">
            <p-skeleton shape="circle" size="80px" styleClass="mx-auto mb-3" />
            <p-skeleton width="120px" height="1.5rem" styleClass="mx-auto" />
          </div>
          }
        </div>
      </div>
      <div class="col-lg-6 mb-4">
        <div class="dept-column d-flex flex-wrap justify-content-center gap-4">
          @for (i of [1, 2, 3]; track i) {
          <div class="dept-card text-center">
            <p-skeleton shape="circle" size="80px" styleClass="mx-auto mb-3" />
            <p-skeleton width="120px" height="1.5rem" styleClass="mx-auto" />
          </div>
          }
        </div>
      </div>
    </div>
    }

    <!-- Error State -->
    @if (error()) {
    <div class="text-center py-5">
      <i class="fas fa-exclamation-triangle fa-3x text-warning mb-3"></i>
      <h4 class="text-white mb-3">{{ error() }}</h4>
      <button class="btn btn-warning" (click)="retry()">
        <i class="fas fa-refresh me-2"></i>Try Again
      </button>
    </div>
    }

    <!-- Success State -->
    @if (!loading() && !error() && hasData()) {
    <div class="row">
      <!-- Left Column -->
      <div class="col-lg-6 mb-4">
        <div class="dept-column d-flex flex-wrap justify-content-center gap-4">
          @for (dept of leftColumnDepts(); track dept.id) {
          <a class="dept-card text-center hover-lift text-decoration-none">
            <div
              class="dept-icon rounded-circle bg-white d-flex align-items-center justify-content-center mx-auto mb-3"
            >
              @if (getDepartmentImage(dept)) {
              <img
                [src]="getDepartmentImage(dept)"
                [alt]="dept.name"
                class="dept-img"
              />
              } @else {
              <i class="fas fa-flask text-primary-custom"></i>
              }
            </div>
            <h5 class="dept-name text-white fw-semibold">{{ dept.name }}</h5>
            @if (dept.subTitle) {
            <p class="dept-subtitle text-white-50 small mb-0">
              {{ dept.subTitle }}
            </p>
            }
          </a>
          }
        </div>
      </div>

      <!-- Right Column -->
      <div class="col-lg-6 mb-4">
        <div class="dept-column d-flex flex-wrap justify-content-center gap-4">
          @for (dept of rightColumnDepts(); track dept.id) {
          <a class="dept-card text-center hover-lift text-decoration-none">
            <div
              class="dept-icon rounded-circle bg-white d-flex align-items-center justify-content-center mx-auto mb-3"
            >
              @if (getDepartmentImage(dept)) {
              <img
                [src]="getDepartmentImage(dept)"
                [alt]="dept.name"
                class="dept-img"
              />
              } @else {
              <i class="fas fa-flask text-primary-custom"></i>
              }
            </div>
            <h5 class="dept-name text-white fw-semibold">{{ dept.name }}</h5>
            @if (dept.subTitle) {
            <p class="dept-subtitle text-white-50 small mb-0">
              {{ dept.subTitle }}
            </p>
            }
          </a>
          }
        </div>
      </div>
    </div>
    }

    <!-- Empty State -->
    @if (!loading() && !error() && !hasData()) {
    <div class="text-center py-5">
      <i class="fas fa-building fa-3x text-white-50 mb-3"></i>
      <h4 class="text-white">No Departments Available</h4>
      <p class="text-white-50">Departments will be added soon.</p>
    </div>
    }
  </div>
</section>
